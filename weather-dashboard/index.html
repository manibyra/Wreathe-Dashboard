<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Weather Dashboard</title>
  <link 
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <div class="container">
    <button class="theme-toggle" onclick="toggleTheme()">ðŸŒ“ Theme</button>
    <h1>Weather Dashboard</h1>
    <input type="text" id="cityInput" placeholder="Enter City Name" />
    <button onclick="getWeather()">Get Weather</button>

    <ul id="historyList"></ul>

    <div id="weatherResult" class="weather-info"></div>
    <div id="forecastResult" class="forecast"></div>
  </div>

  <script>
    const apiKey = 'Your_api_key';

    function toggleTheme() {
      document.body.classList.toggle("dark-mode");
    }

    async function getWeather(cityFromHistory = null) {
      const city = cityFromHistory || document.getElementById('cityInput').value.trim();
      if (!city) return alert("Please enter a city name");

      const urlCurrent = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`;
      const urlForecast = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&units=metric`;

      try {
        const [resCurrent, resForecast] = await Promise.all([fetch(urlCurrent), fetch(urlForecast)]);
        const current = await resCurrent.json();
        const forecast = await resForecast.json();

        if (current.cod != 200) throw new Error(current.message);

        const localTime = new Date(current.dt * 1000).toLocaleString();

        document.getElementById('weatherResult').innerHTML = `
          <div class="header-row">
            <h2>${current.name}</h2>
            <span>${localTime}</span>
          </div>
          <p><strong>${current.weather[0].description}</strong></p>
          <h1>${current.main.temp}Â°C</h1>
          <div class="info-boxes">
            <div class="info-box">Feels like: ${current.main.feels_like}Â°C</div>
            <div class="info-box">Humidity: ${current.main.humidity}%</div>
            <div class="info-box">Wind: ${current.wind.speed} m/s</div>
          </div>
        `;

        const dailyData = forecast.list.filter(item => item.dt_txt.includes("12:00:00")).slice(0, 5);
        document.getElementById('forecastResult').innerHTML = `
          <h3>5-Day Forecast</h3>
          <div class="forecast-cards">
            ${dailyData.map(day => `
              <div class="forecast-card">
                <strong>${new Date(day.dt_txt).toLocaleDateString()}</strong>
                <p>${day.weather[0].main}</p>
                <img src="https://openweathermap.org/img/wn/${day.weather[0].icon}.png" />
                <p>${day.main.temp}Â°C</p>
              </div>
            `).join('')}
          </div>
        `;

        updateHistory(city);

      } catch (err) {
        document.getElementById('weatherResult').innerHTML =
          `<p style="color: red;">Error: ${err.message}</p>`;
        document.getElementById('forecastResult').innerHTML = '';
      }
    }

    function updateHistory(city) {
      let history = JSON.parse(localStorage.getItem('weatherHistory')) || [];
      if (!history.includes(city)) {
        history.unshift(city);
        if (history.length > 5) history.pop();
        localStorage.setItem('weatherHistory', JSON.stringify(history));
      }
      renderHistory();
    }

    function renderHistory() {
      const history = JSON.parse(localStorage.getItem('weatherHistory')) || [];
      const list = document.getElementById('historyList');
      list.innerHTML = '';
      history.forEach(city => {
        const li = document.createElement('li');
        li.innerText = city;
        li.onclick = () => getWeather(city);
        list.appendChild(li);
      });
    }

    window.onload = renderHistory;
  </script>
</body>
</html>

